"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3657],{595:(e,o,r)=>{r.d(o,{I:()=>n});var t=r(2115),a=r(3941);function n(){let[e,o]=(0,t.useState)([]),[r,n]=(0,t.useState)(!0),[s,c]=(0,t.useState)(null),i=async()=>{try{n(!0),c(null),console.log("\uD83D\uDD0D Buscando documentos no Supabase...");let{data:e,error:r}=await a.ND.from("documentos").select("*").order("created_at",{ascending:!1});if(r)throw console.error("❌ Erro ao buscar documentos:",r),r;console.log("✅ Documentos encontrados:",e);let t=(null==e?void 0:e.map(e=>({id:e.id,nome:e.nome,tipo:e.tipo,categoria:e.categoria||"OUTROS",descricao:e.descricao,url:e.url,tamanho:e.tamanho||0,userId:e.user_id,tags:e.tags||[],createdAt:e.created_at?new Date(e.created_at).getTime():Date.now(),updatedAt:e.updated_at?new Date(e.updated_at).getTime():Date.now()})))||[];o(t)}catch(e){console.error("❌ Erro ao buscar documentos:",e),c(e.message)}finally{n(!1)}},l=async e=>{try{console.log("\uD83D\uDCBE Salvando documento no Supabase...",e);let{data:{user:o},error:r}=await a.ND.auth.getUser();if(r||!o)throw Error("Usu\xe1rio n\xe3o autenticado");let t={nome:e.nome,tipo:e.tipo,categoria:e.categoria||"OUTROS",descricao:e.descricao,url:e.url,tamanho:e.tamanho,user_id:o.id,tags:e.tags||[]};console.log("\uD83D\uDCCB Dados para inserir:",t);let{data:n,error:s}=await a.ND.from("documentos").insert([t]).select().single();if(s)throw console.error("❌ Erro ao salvar documento:",s),s;return console.log("✅ Documento salvo com sucesso:",n),await i(),n.id}catch(e){throw console.error("❌ Erro ao adicionar documento:",e),e}},d=async(e,o)=>{try{console.log("\uD83D\uDD04 Atualizando documento:",e,o);let r={nome:o.nome,tipo:o.tipo,categoria:o.categoria,descricao:o.descricao,url:o.url,tamanho:o.tamanho,tags:o.tags,updated_at:new Date().toISOString()},{data:t,error:n}=await a.ND.from("documentos").update(r).eq("id",e).select().single();if(n)throw console.error("❌ Erro ao atualizar documento:",n),n;return console.log("✅ Documento atualizado:",t),await i(),t.id}catch(e){throw console.error("❌ Erro ao atualizar documento:",e),e}},u=async e=>{try{console.log("\uD83D\uDDD1️ Deletando documento:",e);let{error:o}=await a.ND.from("documentos").delete().eq("id",e);if(o)throw console.error("❌ Erro ao deletar documento:",o),o;console.log("✅ Documento deletado com sucesso"),await i()}catch(e){throw console.error("❌ Erro ao deletar documento:",e),e}};return(0,t.useEffect)(()=>{i()},[]),{documentos:e,loading:r,error:s,addDocumento:l,updateDocumento:d,deleteDocumento:u,refetch:i}}},1995:(e,o,r)=>{r.d(o,{A:()=>c});var t=r(5155),a=r(2115),n=r(3941),s=r(4744);function c(e){let{onUploadComplete:o}=e,[r,c]=(0,a.useState)(null),[i,l]=(0,a.useState)(!1),[d,u]=(0,a.useState)(!1),m=(0,a.useRef)(null),g=e=>{e.preventDefault(),e.stopPropagation(),"dragenter"===e.type||"dragover"===e.type?u(!0):"dragleave"===e.type&&u(!1)},p=async()=>{if(!r)return void s.oR.error("Selecione um arquivo primeiro");l(!0);try{console.log("\uD83D\uDE80 Iniciando upload simplificado...");let e=Date.now(),t=r.name.replace(/[^a-zA-Z0-9.-]/g,"_").replace(/_+/g,"_").replace(/^_|_$/g,""),a="".concat(e,"_").concat(t),i="uploads/".concat(a);console.log("\uD83D\uDCC2 Caminho do arquivo:",i);let{data:l,error:d}=await n.ND.storage.from("documentos").upload(i,r);if(d)throw console.error("❌ Erro no upload:",d),Error("Erro no upload: ".concat(d.message));console.log("✅ Upload conclu\xeddo:",l);let{data:{publicUrl:u}}=n.ND.storage.from("documentos").getPublicUrl(i);console.log("\uD83D\uDD17 URL p\xfablica:",u);let g={nome:r.name,tipo:r.name.toLowerCase().endsWith(".pdf")?"PDF":r.name.toLowerCase().match(/\.(jpg|jpeg|png|gif|bmp|webp|tiff)$/)?"IMAGEM":"EXCEL",categoria:"OUTROS",descricao:"Upload simplificado - ".concat(new Date().toLocaleString("pt-BR")),url:u,tamanho:r.size,user_id:null,tags:["upload-simples"]},{error:p}=await n.ND.from("documentos").insert([g]);p&&console.warn("⚠️ Erro ao salvar no banco (mas upload foi feito):",p),s.oR.success("Arquivo enviado com sucesso!"),o&&o(u,r.name),c(null),m.current&&(m.current.value="")}catch(e){console.error("❌ Erro no upload:",e),s.oR.error("Erro ao fazer upload: ".concat(e.message||"Erro desconhecido"))}finally{l(!1)}};return(0,t.jsxs)("div",{className:"bg-white dark:bg-zinc-800 rounded-xl p-6 w-full max-w-2xl",children:[(0,t.jsx)("h2",{className:"text-xl font-bold mb-6 text-zinc-900 dark:text-zinc-100",children:"\uD83D\uDCC1 Upload Simples de Documentos"}),(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"relative w-full h-40 border-2 border-dashed rounded-lg cursor-pointer transition-colors ".concat(d?"border-indigo-500 bg-indigo-50 dark:bg-indigo-900/20":"border-zinc-300 dark:border-zinc-600 bg-zinc-100 dark:bg-zinc-800 hover:bg-zinc-200 dark:hover:bg-zinc-750 hover:border-indigo-500"),onDragEnter:g,onDragLeave:g,onDragOver:g,onDrop:e=>{e.preventDefault(),e.stopPropagation(),u(!1),e.dataTransfer.files&&e.dataTransfer.files[0]&&(c(e.dataTransfer.files[0]),s.oR.success("Arquivo selecionado!"))},onClick:()=>{var e;return null==(e=m.current)?void 0:e.click()},children:[(0,t.jsx)("input",{ref:m,type:"file",accept:".pdf,.xlsx,.xls,.doc,.docx,.txt,.jpg,.jpeg,.png,.gif,.bmp,.webp,.tiff",onChange:e=>{e.target.files&&e.target.files[0]&&(c(e.target.files[0]),s.oR.success("Arquivo selecionado!"))},className:"hidden"}),(0,t.jsxs)("div",{className:"flex flex-col items-center justify-center h-full",children:[(0,t.jsx)("svg",{className:"w-12 h-12 mb-4 text-zinc-500 dark:text-zinc-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})}),(0,t.jsxs)("p",{className:"text-sm text-zinc-600 dark:text-zinc-400 text-center",children:[(0,t.jsx)("span",{className:"font-medium",children:"Clique para selecionar"}),(0,t.jsx)("br",{}),"ou arraste e solte o arquivo aqui"]}),(0,t.jsx)("p",{className:"text-xs text-zinc-500 dark:text-zinc-500 mt-2",children:"PDF, Excel, Word, Fotos/Imagens (m\xe1x. 50MB)"})]})]}),r&&(0,t.jsx)("div",{className:"p-4 bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-lg",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("span",{className:"text-green-600 dark:text-green-400 text-2xl",children:r.name.toLowerCase().endsWith(".pdf")?"\uD83D\uDCC4":r.name.toLowerCase().endsWith(".xlsx")||r.name.toLowerCase().endsWith(".xls")?"\uD83D\uDCCA":r.name.toLowerCase().endsWith(".doc")||r.name.toLowerCase().endsWith(".docx")?"\uD83D\uDCDD":r.name.toLowerCase().match(/\.(jpg|jpeg|png|gif|bmp|webp|tiff)$/)?"\uD83D\uDDBC️":"\uD83D\uDCC1"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm font-medium text-green-800 dark:text-green-200",children:r.name}),(0,t.jsx)("p",{className:"text-xs text-green-600 dark:text-green-400",children:(e=>{if(0===e)return"0 Bytes";let o=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,o)).toFixed(2))+" "+["Bytes","KB","MB","GB"][o]})(r.size)})]})]}),(0,t.jsx)("button",{type:"button",onClick:()=>{c(null),m.current&&(m.current.value="")},className:"text-red-500 hover:text-red-700 dark:text-red-400 dark:hover:text-red-300",children:(0,t.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}),(0,t.jsx)("button",{onClick:p,disabled:!r||i,className:"w-full bg-indigo-600 hover:bg-indigo-500 disabled:bg-zinc-400 text-white py-3 px-6 rounded-lg font-medium transition-colors flex items-center justify-center gap-2",children:i?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("svg",{className:"animate-spin w-5 h-5",fill:"none",viewBox:"0 0 24 24",children:[(0,t.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,t.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Enviando..."]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})}),"Enviar Arquivo"]})}),(0,t.jsxs)("div",{className:"text-xs text-zinc-500 dark:text-zinc-400 text-center",children:[(0,t.jsx)("p",{children:"✅ Upload direto para nuvem"}),(0,t.jsx)("p",{children:"✅ Sem necessidade de login"}),(0,t.jsx)("p",{children:"✅ Acesso de qualquer dispositivo"})]})]})]})}},3941:(e,o,r)=>{r.d(o,{ND:()=>c});var t=r(945),a=r(5704);let n=a.env.NEXT_PUBLIC_SUPABASE_URL||"https://rzurwjixlqremctcpwhk.supabase.co",s=a.env.NEXT_PUBLIC_SUPABASE_ANON_KEY||"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InJ6dXJ3aml4bHFyZW1jdGNwd2hrIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTg4MzI1OTAsImV4cCI6MjA3NDQwODU5MH0.0h2LZLii3bQrV1anVQ9VIPog6RfHO9RuhI22G4V994Y",c=(0,t.UU)(n,s,{auth:{autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0}})}}]);