(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4520],{63:(e,t,r)=>{"use strict";var o=r(7260);r.o(o,"usePathname")&&r.d(t,{usePathname:function(){return o.usePathname}}),r.o(o,"useRouter")&&r.d(t,{useRouter:function(){return o.useRouter}})},399:(e,t,r)=>{Promise.resolve().then(r.bind(r,5404))},3361:(e,t,r)=>{"use strict";r.d(t,{y1:()=>n,yM:()=>l});let o=r(5704).env.NEXT_PUBLIC_API_URL||"http://localhost:3001/api";class a{setToken(e){this.token=e}clearToken(){this.token=null}async request(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r="".concat(this.baseURL).concat(e),o={headers:{"Content-Type":"application/json",...t.headers},...t};this.token&&(o.headers.Authorization="Bearer ".concat(this.token));try{let e,t=await fetch(r,o),a=t.headers.get("content-type");if(e=a&&a.includes("application/json")?await t.json():await t.blob(),!t.ok)throw Error(e.error||"HTTP ".concat(t.status));return e}catch(e){throw console.error("Erro na requisi\xe7\xe3o:",e),e}}async get(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.request(e,{method:"GET",...t})}async post(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.request(e,{method:"POST",body:JSON.stringify(t),...r})}async put(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.request(e,{method:"PUT",body:JSON.stringify(t),...r})}async delete(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.request(e,{method:"DELETE",...t})}async uploadFile(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=new FormData;o.append("file",t),Object.keys(r).forEach(e=>{o.append(e,r[e])});let a="".concat(this.baseURL).concat(e),s={method:"POST",body:o,headers:{}};this.token&&(s.headers.Authorization="Bearer ".concat(this.token));try{let e=await fetch(a,s),t=await e.json();if(!e.ok)throw Error(t.error||"HTTP ".concat(e.status));return t}catch(e){throw console.error("Erro no upload:",e),e}}async uploadMultipleFiles(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=new FormData;t.forEach(e=>{o.append("files",e)}),Object.keys(r).forEach(e=>{o.append(e,r[e])});let a="".concat(this.baseURL).concat(e),s={method:"POST",body:o,headers:{}};this.token&&(s.headers.Authorization="Bearer ".concat(this.token));try{let e=await fetch(a,s),t=await e.json();if(!e.ok)throw Error(t.error||"HTTP ".concat(e.status));return t}catch(e){throw console.error("Erro no upload m\xfaltiplo:",e),e}}constructor(){this.baseURL=o,this.token=null}}let s=new a,n={async login(e,t){let r=await s.post("/auth/login",{email:e,password:t});return r.token&&(s.setToken(r.token),localStorage.setItem("auth_token",r.token)),r},register:async e=>s.post("/auth/register",e),logout:async()=>(s.clearToken(),localStorage.removeItem("auth_token"),s.post("/auth/logout")),getProfile:async()=>s.get("/auth/profile"),updateProfile:async e=>s.put("/auth/profile",e),changePassword:async e=>s.put("/auth/change-password",e),initToken(){let e=localStorage.getItem("auth_token");e&&s.setToken(e)}},l={async list(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=new URLSearchParams;Object.keys(e).forEach(r=>{void 0!==e[r]&&null!==e[r]&&t.append(r,e[r])});let r=t.toString()?"?".concat(t.toString()):"";return s.get("/relatorios".concat(r))},getById:async e=>s.get("/relatorios/".concat(e)),create:async e=>s.post("/relatorios",e),update:async(e,t)=>s.put("/relatorios/".concat(e),t),delete:async e=>s.delete("/relatorios/".concat(e)),generatePDF:async e=>s.post("/relatorios/".concat(e,"/generate-pdf")),downloadPDF:async(e,t)=>s.get("/relatorios/".concat(e,"/pdf/").concat(t))}},5404:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>i});var o=r(5155),a=r(2115),s=r(8209),n=r(63),l=r(4744);function i(){let[e,t]=(0,a.useState)(""),[r,i]=(0,a.useState)(""),[c,d]=(0,a.useState)(!1),[u,h]=(0,a.useState)(!1),[m,g]=(0,a.useState)(null),{login:p}=(0,s.A)();(0,n.useRouter)(),(0,a.useEffect)(()=>{let e=localStorage.getItem("savedUsername");e&&(g(e),t(e),h(!0))},[]);let f=async t=>{if(t.preventDefault(),!e.trim()||!r.trim())return void l.oR.error("Preencha todos os campos");d(!0);try{await p(e,r)?(u?localStorage.setItem("savedUsername",e):localStorage.removeItem("savedUsername"),l.oR.success("Login realizado com sucesso!"),setTimeout(()=>{window.location.href="/relatorios"},1e3)):(l.oR.error("Usu\xe1rio ou senha incorretos"),d(!1))}catch(e){l.oR.error("Erro ao fazer login"),d(!1)}},b=async()=>{if(m){d(!0);try{await p(m,"2020")?(l.oR.success("Login r\xe1pido realizado!"),setTimeout(()=>{window.location.href="/relatorios"},1e3)):(l.oR.error("Erro no login r\xe1pido"),d(!1))}catch(e){l.oR.error("Erro no login r\xe1pido"),d(!1)}}};return(0,o.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 dark:from-slate-900 dark:to-blue-900 flex items-center justify-center p-4",children:(0,o.jsxs)("div",{className:"w-full max-w-md",children:[(0,o.jsxs)("div",{className:"text-center mb-8",children:[(0,o.jsx)("div",{className:"mx-auto w-16 h-16 bg-gradient-to-r from-blue-600 to-purple-600 rounded-full flex items-center justify-center mb-4",children:(0,o.jsx)("svg",{className:"w-8 h-8 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,o.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"})})}),(0,o.jsx)("h1",{className:"text-3xl font-bold text-slate-800 dark:text-slate-200 mb-2",children:"Relat\xf3rios Limpebras"}),(0,o.jsx)("p",{className:"text-slate-600 dark:text-slate-400",children:"Fa\xe7a login para acessar o sistema"})]}),(0,o.jsx)("div",{className:"bg-white dark:bg-slate-800 rounded-xl shadow-lg p-8",children:(0,o.jsxs)("form",{onSubmit:f,className:"space-y-6",children:[(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{className:"block text-sm font-semibold text-slate-700 dark:text-slate-300 mb-2",children:"Usu\xe1rio"}),(0,o.jsx)("input",{type:"text",value:e,onChange:e=>t(e.target.value),className:"w-full px-4 py-3 bg-slate-50 dark:bg-slate-700 text-slate-800 dark:text-slate-200 rounded-lg border border-slate-300 dark:border-slate-600 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 dark:focus:ring-blue-800 transition-all duration-200",placeholder:"Digite seu usu\xe1rio",required:!0})]}),(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{className:"block text-sm font-semibold text-slate-700 dark:text-slate-300 mb-2",children:"Senha"}),(0,o.jsx)("input",{type:"password",value:r,onChange:e=>i(e.target.value),className:"w-full px-4 py-3 bg-slate-50 dark:bg-slate-700 text-slate-800 dark:text-slate-200 rounded-lg border border-slate-300 dark:border-slate-600 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 dark:focus:ring-blue-800 transition-all duration-200",placeholder:"Digite sua senha",required:!0})]}),(0,o.jsxs)("div",{className:"flex items-center",children:[(0,o.jsx)("input",{type:"checkbox",id:"rememberUser",checked:u,onChange:e=>h(e.target.checked),className:"w-4 h-4 text-blue-600 bg-slate-100 border-slate-300 rounded focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-slate-800 focus:ring-2 dark:bg-slate-700 dark:border-slate-600"}),(0,o.jsx)("label",{htmlFor:"rememberUser",className:"ml-2 text-sm text-slate-700 dark:text-slate-300",children:"\uD83D\uDCBE Lembrar usu\xe1rio"})]}),(0,o.jsx)("button",{type:"submit",disabled:c,className:"w-full py-3 px-4 rounded-lg font-semibold transition-all duration-200 flex items-center justify-center gap-2 ".concat(c?"bg-slate-400 cursor-not-allowed text-slate-200":"bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 text-white shadow-lg hover:shadow-xl"),children:c?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)("svg",{className:"animate-spin h-5 w-5",fill:"none",viewBox:"0 0 24 24",children:[(0,o.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,o.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Entrando..."]}):(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,o.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 16l-4-4m0 0l4-4m-4 4h14m-5 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h7a3 3 0 013 3v1"})}),"Entrar"]})}),m&&(0,o.jsxs)("button",{type:"button",onClick:b,disabled:c,className:"w-full py-2 px-4 rounded-lg font-medium transition-all duration-200 flex items-center justify-center gap-2 ".concat(c?"bg-slate-300 cursor-not-allowed text-slate-400":"bg-gradient-to-r from-green-500 to-emerald-600 hover:from-green-600 hover:to-emerald-700 text-white shadow-md hover:shadow-lg"),children:[(0,o.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,o.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})}),"âš¡ Login R\xe1pido (",m,")"]})]})}),(0,o.jsxs)("div",{className:"text-center mt-6 text-sm text-slate-500 dark:text-slate-400",children:[(0,o.jsx)("p",{children:"Sistema de Relat\xf3rios - Limpebras"}),(0,o.jsx)("p",{children:"\xa9 2024 - Todos os direitos reservados"})]})]})})}},8209:(e,t,r)=>{"use strict";r.d(t,{A:()=>n,Y:()=>l});var o=r(2115),a=r(3361);let s={"marcos.silva":"marcos.silva@limpebras.com",admin:"admin@test.com","admin@test.com":"admin@test.com",usuario1:"usuario1@limpebras.com",usuario2:"usuario2@limpebras.com"};function n(){let[e,t]=(0,o.useState)({isAuthenticated:!1,user:null,isLoading:!0,login:async()=>!1,logout:()=>{},isAdmin:!1});(0,o.useEffect)(()=>{localStorage.getItem("auth_token")?(a.y1.initToken(),a.y1.getProfile().then(e=>{t(t=>({...t,isAuthenticated:!0,user:{id:e.id,nome:e.nome,email:e.email,username:e.email.split("@")[0],role:e.role,created_at:e.created_at},isLoading:!1,isAdmin:"admin"===e.role}))}).catch(e=>{console.error("Token inv\xe1lido:",e),localStorage.removeItem("auth_token"),t(e=>({...e,isAuthenticated:!1,user:null,isLoading:!1,isAdmin:!1}))})):t(e=>({...e,isAuthenticated:!1,user:null,isLoading:!1,isAdmin:!1}))},[]);let r=async(e,r)=>{try{let o=s[e]||e,n=await a.y1.login(o,r);if(n.token&&n.user)return t(t=>({...t,isAuthenticated:!0,user:{id:n.user.id,nome:n.user.nome,email:n.user.email,username:e,role:n.user.role},isLoading:!1,isAdmin:"admin"===n.user.role})),console.log("Login successful, user authenticated:",n.user),!0;return console.log("Login failed - invalid response"),!1}catch(e){return console.error("Erro no login:",e),!1}};return{...e,login:r,logout:()=>{a.y1.logout(),t(e=>({...e,isAuthenticated:!1,user:null,isLoading:!1,isAdmin:!1}))},isAdmin:e.isAdmin}}function l(){let[e,t]=(0,o.useState)([]),[r,s]=(0,o.useState)(!1),n=async()=>{try{s(!0),t([])}catch(e){console.error("Erro ao carregar usu\xe1rios:",e)}finally{s(!1)}};return(0,o.useEffect)(()=>{n()},[]),{users:e,loading:r,addUser:async e=>{try{let t=await a.y1.register(e);return await n(),t.user}catch(e){throw console.error("Erro ao adicionar usu\xe1rio:",e),e}},updateUser:async(e,t)=>{try{await a.y1.updateProfile(t),await n()}catch(e){throw console.error("Erro ao atualizar usu\xe1rio:",e),e}},deleteUser:async e=>{try{await n()}catch(e){throw console.error("Erro ao deletar usu\xe1rio:",e),e}},toggleUserStatus:async e=>{try{await n()}catch(e){throw console.error("Erro ao alterar status do usu\xe1rio:",e),e}},refreshUsers:n}}}},e=>{e.O(0,[4744,8441,1255,7358],()=>e(e.s=399)),_N_E=e.O()}]);