(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7177],{63:(e,r,t)=>{"use strict";var o=t(7260);t.o(o,"usePathname")&&t.d(r,{usePathname:function(){return o.usePathname}}),t.o(o,"useRouter")&&t.d(r,{useRouter:function(){return o.useRouter}})},1290:()=>{},2365:(e,r,t)=>{Promise.resolve().then(t.bind(t,6466)),Promise.resolve().then(t.bind(t,2870)),Promise.resolve().then(t.t.bind(t,4587,23)),Promise.resolve().then(t.t.bind(t,4705,23)),Promise.resolve().then(t.t.bind(t,1290,23)),Promise.resolve().then(t.bind(t,4744)),Promise.resolve().then(t.t.bind(t,3262,23))},2870:(e,r,t)=>{"use strict";t.d(r,{D:()=>n,ThemeProvider:()=>i});var o=t(5155),s=t(2115);let a=(0,s.createContext)(void 0);function i(e){let{children:r}=e,[t,i]=(0,s.useState)(!1);return(0,s.useEffect)(()=>{let e="dark"===(localStorage.getItem("theme")||"light");i(e),document.documentElement.classList.toggle("dark",e)},[]),(0,o.jsx)(a.Provider,{value:{isDark:t,toggleTheme:()=>{let e=!t;i(e),localStorage.setItem("theme",e?"dark":"light"),document.documentElement.classList.toggle("dark",e)},setTheme:e=>{let r="dark"===e;i(r),localStorage.setItem("theme",e),document.documentElement.classList.toggle("dark",r)}},children:r})}function n(){let e=(0,s.useContext)(a);if(void 0===e)throw Error("useTheme must be used within a ThemeProvider");return e}},3262:()=>{},3361:(e,r,t)=>{"use strict";t.d(r,{y1:()=>i,yM:()=>n});let o=t(5704).env.NEXT_PUBLIC_API_URL||"http://localhost:3001/api";class s{setToken(e){this.token=e}clearToken(){this.token=null}async request(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t="".concat(this.baseURL).concat(e),o={headers:{"Content-Type":"application/json",...r.headers},...r};this.token&&(o.headers.Authorization="Bearer ".concat(this.token));try{let e,r=await fetch(t,o),s=r.headers.get("content-type");if(e=s&&s.includes("application/json")?await r.json():await r.blob(),!r.ok)throw Error(e.error||"HTTP ".concat(r.status));return e}catch(e){throw console.error("Erro na requisi\xe7\xe3o:",e),e}}async get(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.request(e,{method:"GET",...r})}async post(e,r){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.request(e,{method:"POST",body:JSON.stringify(r),...t})}async put(e,r){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.request(e,{method:"PUT",body:JSON.stringify(r),...t})}async delete(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.request(e,{method:"DELETE",...r})}async uploadFile(e,r){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=new FormData;o.append("file",r),Object.keys(t).forEach(e=>{o.append(e,t[e])});let s="".concat(this.baseURL).concat(e),a={method:"POST",body:o,headers:{}};this.token&&(a.headers.Authorization="Bearer ".concat(this.token));try{let e=await fetch(s,a),r=await e.json();if(!e.ok)throw Error(r.error||"HTTP ".concat(e.status));return r}catch(e){throw console.error("Erro no upload:",e),e}}async uploadMultipleFiles(e,r){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=new FormData;r.forEach(e=>{o.append("files",e)}),Object.keys(t).forEach(e=>{o.append(e,t[e])});let s="".concat(this.baseURL).concat(e),a={method:"POST",body:o,headers:{}};this.token&&(a.headers.Authorization="Bearer ".concat(this.token));try{let e=await fetch(s,a),r=await e.json();if(!e.ok)throw Error(r.error||"HTTP ".concat(e.status));return r}catch(e){throw console.error("Erro no upload m\xfaltiplo:",e),e}}constructor(){this.baseURL=o,this.token=null}}let a=new s,i={async login(e,r){let t=await a.post("/auth/login",{email:e,password:r});return t.token&&(a.setToken(t.token),localStorage.setItem("auth_token",t.token)),t},register:async e=>a.post("/auth/register",e),logout:async()=>(a.clearToken(),localStorage.removeItem("auth_token"),a.post("/auth/logout")),getProfile:async()=>a.get("/auth/profile"),updateProfile:async e=>a.put("/auth/profile",e),changePassword:async e=>a.put("/auth/change-password",e),initToken(){let e=localStorage.getItem("auth_token");e&&a.setToken(e)}},n={async list(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=new URLSearchParams;Object.keys(e).forEach(t=>{void 0!==e[t]&&null!==e[t]&&r.append(t,e[t])});let t=r.toString()?"?".concat(r.toString()):"";return a.get("/relatorios".concat(t))},getById:async e=>a.get("/relatorios/".concat(e)),create:async e=>a.post("/relatorios",e),update:async(e,r)=>a.put("/relatorios/".concat(e),r),delete:async e=>a.delete("/relatorios/".concat(e)),generatePDF:async e=>a.post("/relatorios/".concat(e,"/generate-pdf")),downloadPDF:async(e,r)=>a.get("/relatorios/".concat(e,"/pdf/").concat(r))}},4587:e=>{e.exports={style:{fontFamily:"'Geist', 'Geist Fallback'",fontStyle:"normal"},className:"__className_188709",variable:"__variable_188709"}},4705:e=>{e.exports={style:{fontFamily:"'Geist Mono', 'Geist Mono Fallback'",fontStyle:"normal"},className:"__className_9a8899",variable:"__variable_9a8899"}},6466:(e,r,t)=>{"use strict";t.d(r,{ConditionalLayout:()=>h});var o=t(5155),s=t(63),a=t(2619),i=t.n(a),n=t(2115),l=t(8209);function c(){var e,r;let[t,s]=(0,n.useState)(!1),{user:a,logout:c,isAdmin:d}=(0,l.A)(),[h,u]=(0,n.useState)(!1);return(0,n.useEffect)(()=>{s("dark"===(localStorage.getItem("theme")||"light"))},[]),(0,n.useEffect)(()=>{let e=e=>{e.target.closest(".user-menu-container")||u(!1)};return h&&document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[h]),(0,o.jsx)("header",{className:"w-full border-b border-zinc-200 dark:border-white/10 bg-white dark:bg-zinc-900 text-zinc-900 dark:text-zinc-100",children:(0,o.jsxs)("nav",{className:"mx-auto max-w-6xl px-4 py-3 flex items-center justify-between",children:[(0,o.jsxs)("div",{className:"font-bold text-2xl text-purple-600 dark:text-purple-500",children:[(0,o.jsx)("span",{className:"mr-2",children:"\uD83D\uDC7B"})," Relat\xf3rios - Limpebras"]}),(0,o.jsxs)("ul",{className:"flex items-center gap-4 text-sm font-bold",children:[(0,o.jsx)("li",{children:(0,o.jsxs)(i(),{href:"/",className:"hover:text-zinc-600 dark:hover:text-white flex items-center gap-1",children:[(0,o.jsx)("svg",{className:"w-4 h-4 font-bold text-purple-600 dark:text-purple-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,o.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"})}),"Home"]})}),(0,o.jsx)("li",{children:(0,o.jsxs)(i(),{href:"/relatorios",className:"hover:text-zinc-600 dark:hover:text-white flex items-center gap-1",children:[(0,o.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,o.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"Consultas"]})}),d&&(0,o.jsxs)("li",{className:"relative group",children:[(0,o.jsxs)("button",{className:"hover:text-zinc-600 font-bold dark:hover:text-white flex items-center gap-1",children:["Cadastro",(0,o.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,o.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),(0,o.jsx)("div",{className:"absolute top-full left-0 mt-1 w-64 bg-white dark:bg-zinc-800 border border-zinc-200 dark:border-zinc-700 rounded shadow-lg opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200 z-50",children:(0,o.jsxs)("div",{className:"py-2",children:[(0,o.jsx)(i(),{href:"/relatorios/novo-registro",className:"block px-4 py-2 hover:bg-zinc-100 dark:hover:bg-zinc-700",children:"Registros"}),(0,o.jsx)(i(),{href:"/relatorios/novo",className:"block px-4 py-2 hover:bg-zinc-100 dark:hover:bg-zinc-700",children:"Mutir\xe3o"}),(0,o.jsx)(i(),{href:"/relatorios/novo-revitalizacao",className:"block px-4 py-2 hover:bg-zinc-100 dark:hover:bg-zinc-700",children:"Revitaliza\xe7\xe3o"}),(0,o.jsx)(i(),{href:"/relatorios/novo-rotineiros",className:"block px-4 py-2 hover:bg-zinc-100 dark:hover:bg-zinc-700",children:"Servi\xe7os Rotineiros"}),(0,o.jsx)(i(),{href:"/relatorios/novo-ecopontos",className:"block px-4 py-2 hover:bg-zinc-100 dark:hover:bg-zinc-700",children:"Ecopontos"}),(0,o.jsx)(i(),{href:"/relatorios/novo-dds",className:"block px-4 py-2 hover:bg-zinc-100 dark:hover:bg-zinc-700",children:"DDS"}),(0,o.jsx)(i(),{href:"/relatorios/novo-eventos",className:"block px-4 py-2 hover:bg-zinc-100 dark:hover:bg-zinc-700",children:"Eventos"}),(0,o.jsx)("div",{className:"border-t border-zinc-200 dark:border-zinc-700 my-1"}),(0,o.jsx)(i(),{href:"/cadastros/eventos",className:"block px-4 py-2 hover:bg-zinc-100 dark:hover:bg-zinc-700 text-purple-600 dark:text-purple-400 font-semibold",children:"\uD83C\uDFAA Eventos"}),(0,o.jsx)(i(),{href:"/cadastro-usuarios",className:"block px-4 py-2 hover:bg-zinc-100 dark:hover:bg-zinc-700 text-purple-600 dark:text-purple-400 font-semibold",children:"\uD83D\uDC65 Usu\xe1rios"})]})})]}),(0,o.jsxs)("li",{className:"relative group",children:[(0,o.jsxs)("button",{className:"hover:text-zinc-600 dark:hover:text-white flex items-center gap-1",children:["Relat\xf3rios",(0,o.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,o.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),(0,o.jsx)("div",{className:"absolute top-full left-0 mt-1 w-48 bg-white dark:bg-zinc-800 border border-zinc-200 dark:border-zinc-700 rounded shadow-lg opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200 z-50",children:(0,o.jsxs)("div",{className:"py-2",children:[(0,o.jsx)(i(),{href:"/relatorios/evidencias",className:"block px-4 py-2 hover:bg-zinc-100 dark:hover:bg-zinc-700",children:"Evid\xeancias - Mutir\xf5es"}),(0,o.jsx)(i(),{href:"/relatorios/evidencias-registros",className:"block px-4 py-2 hover:bg-zinc-100 dark:hover:bg-zinc-700",children:"Evid\xeancias - Registros"}),(0,o.jsx)(i(),{href:"/relatorios/evidencias-revitalizacoes",className:"block px-4 py-2 hover:bg-zinc-100 dark:hover:bg-zinc-700",children:"Evid\xeancias - Revitaliza"}),(0,o.jsx)(i(),{href:"/relatorios/evidencias-rotineiros",className:"block px-4 py-2 hover:bg-zinc-100 dark:hover:bg-zinc-700",children:"Evid\xeancias - Rotineiros"})]})})]}),(0,o.jsxs)("li",{className:"relative user-menu-container",children:[(0,o.jsxs)("button",{onClick:()=>u(!h),className:"flex items-center gap-2 p-2 rounded-lg hover:bg-zinc-100 dark:hover:bg-zinc-800 transition-colors duration-200",children:[(0,o.jsx)("div",{className:"w-8 h-8 rounded-full flex items-center justify-center text-white font-bold text-sm ".concat((null==a?void 0:a.role)==="admin"?"bg-gradient-to-r from-purple-500 to-pink-500":"bg-gradient-to-r from-blue-500 to-cyan-500"),children:(null==a||null==(e=a.nome)?void 0:e.charAt(0).toUpperCase())||"U"}),(0,o.jsxs)("div",{className:"text-left hidden md:block",children:[(0,o.jsx)("div",{className:"text-sm font-semibold",children:(null==a?void 0:a.nome)||"Usu\xe1rio"}),(0,o.jsx)("div",{className:"text-xs text-zinc-500 dark:text-zinc-400",children:(null==a?void 0:a.role)==="admin"?"\uD83D\uDC51 Admin":"\uD83D\uDC64 Usu\xe1rio"})]}),(0,o.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,o.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),h&&(0,o.jsxs)("div",{className:"absolute top-full right-0 mt-2 w-64 bg-white dark:bg-zinc-800 border border-zinc-200 dark:border-zinc-700 rounded-lg shadow-lg z-50",children:[(0,o.jsx)("div",{className:"p-4 border-b border-zinc-200 dark:border-zinc-700",children:(0,o.jsxs)("div",{className:"flex items-center gap-3",children:[(0,o.jsx)("div",{className:"w-12 h-12 rounded-full flex items-center justify-center text-white font-bold ".concat((null==a?void 0:a.role)==="admin"?"bg-gradient-to-r from-purple-500 to-pink-500":"bg-gradient-to-r from-blue-500 to-cyan-500"),children:(null==a||null==(r=a.nome)?void 0:r.charAt(0).toUpperCase())||"U"}),(0,o.jsxs)("div",{children:[(0,o.jsx)("div",{className:"font-semibold text-zinc-800 dark:text-zinc-200",children:(null==a?void 0:a.nome)||"Usu\xe1rio"}),(0,o.jsx)("div",{className:"text-sm text-zinc-500 dark:text-zinc-400",children:(null==a?void 0:a.email)||"email@exemplo.com"}),(0,o.jsx)("div",{className:"text-xs text-purple-600 dark:text-purple-400 font-semibold",children:(null==a?void 0:a.role)==="admin"?"\uD83D\uDC51 Administrador":"\uD83D\uDC64 Usu\xe1rio"})]})]})}),(0,o.jsxs)("div",{className:"py-2",children:[d&&(0,o.jsx)(i(),{href:"/cadastro-usuarios",className:"block px-4 py-2 hover:bg-zinc-100 dark:hover:bg-zinc-700 text-purple-600 dark:text-purple-400 font-semibold",onClick:()=>u(!1),children:(0,o.jsxs)("div",{className:"flex items-center gap-2",children:[(0,o.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,o.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197m13.5-9a2.5 2.5 0 11-5 0 2.5 2.5 0 015 0z"})}),"\uD83D\uDC65 Gerenciar Usu\xe1rios"]})}),(0,o.jsx)("button",{onClick:()=>{c(),u(!1),window.location.href="/"},className:"w-full text-left px-4 py-2 hover:bg-red-50 dark:hover:bg-red-900/20 text-red-600 dark:text-red-400 font-semibold",children:(0,o.jsxs)("div",{className:"flex items-center gap-2",children:[(0,o.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,o.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})}),"\uD83D\uDEAA Sair"]})})]})]})]}),(0,o.jsx)("li",{children:(0,o.jsx)("button",{onClick:()=>{let e=t?"light":"dark";s(!t),localStorage.setItem("theme",e),document.documentElement.classList.toggle("dark","dark"===e)},className:"p-2 rounded-lg hover:bg-zinc-100 dark:hover:bg-zinc-800 transition-colors duration-200 flex items-center justify-center",title:"Alternar tema",children:t?(0,o.jsx)("svg",{className:"w-5 h-5 text-yellow-400",fill:"currentColor",viewBox:"0 0 20 20",children:(0,o.jsx)("path",{fillRule:"evenodd",d:"M10 2a1 1 0 011 1v1a1 1 0 11-2 0V3a1 1 0 011-1zm4 8a4 4 0 11-8 0 4 4 0 018 0zm-.464 4.95l.707.707a1 1 0 001.414-1.414l-.707-.707a1 1 0 00-1.414 1.414zm2.12-10.607a1 1 0 010 1.414l-.706.707a1 1 0 11-1.414-1.414l.707-.707a1 1 0 011.414 0zM17 11a1 1 0 100-2h-1a1 1 0 100 2h1zm-7 4a1 1 0 011 1v1a1 1 0 11-2 0v-1a1 1 0 011-1zM5.05 6.464A1 1 0 106.465 5.05l-.708-.707a1 1 0 00-1.414 1.414l.707.707zm1.414 8.486l-.707.707a1 1 0 01-1.414-1.414l.707-.707a1 1 0 011.414 1.414zM4 11a1 1 0 100-2H3a1 1 0 000 2h1z",clipRule:"evenodd"})}):(0,o.jsx)("svg",{className:"w-5 h-5 text-yellow-400",fill:"currentColor",viewBox:"0 0 20 20",children:(0,o.jsx)("path",{fillRule:"evenodd",d:"M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z",clipRule:"evenodd"})})})})]})]})})}function d(e){let{children:r}=e,{isAuthenticated:t,isLoading:a}=(0,l.A)(),i=(0,s.useRouter)(),c=(0,s.usePathname)(),d=["/login"].includes(c);return((0,n.useEffect)(()=>{if(!a){if(!t&&!d)return void i.push("/login");if(t&&"/login"===c)return void setTimeout(()=>{window.location.href="/relatorios"},100)}},[t,a,c,i,d]),a)?(0,o.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-blue-50 dark:from-slate-900 dark:to-blue-900 flex items-center justify-center",children:(0,o.jsxs)("div",{className:"text-center",children:[(0,o.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),(0,o.jsx)("p",{className:"text-slate-600 dark:text-slate-400",children:"Verificando autentica\xe7\xe3o..."})]})}):(t||d)&&(!t||"/login"!==c)?(0,o.jsx)(o.Fragment,{children:r}):null}function h(e){let{children:r}=e,t=["/login"].includes((0,s.usePathname)());return(0,o.jsx)(d,{children:t?(0,o.jsx)(o.Fragment,{children:r}):(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(c,{}),(0,o.jsx)("main",{className:"mx-auto max-w-7xl px-4 py-6",children:r})]})})}},8209:(e,r,t)=>{"use strict";t.d(r,{A:()=>i,Y:()=>n});var o=t(2115),s=t(3361);let a={"marcos.silva":"marcos.silva@limpebras.com",admin:"admin@test.com","admin@test.com":"admin@test.com",usuario1:"usuario1@limpebras.com",usuario2:"usuario2@limpebras.com"};function i(){let[e,r]=(0,o.useState)({isAuthenticated:!1,user:null,isLoading:!0,login:async()=>!1,logout:()=>{},isAdmin:!1});(0,o.useEffect)(()=>{localStorage.getItem("auth_token")?(s.y1.initToken(),s.y1.getProfile().then(e=>{r(r=>({...r,isAuthenticated:!0,user:{id:e.id,nome:e.nome,email:e.email,username:e.email.split("@")[0],role:e.role,created_at:e.created_at},isLoading:!1,isAdmin:"admin"===e.role}))}).catch(e=>{console.error("Token inv\xe1lido:",e),localStorage.removeItem("auth_token"),r(e=>({...e,isAuthenticated:!1,user:null,isLoading:!1,isAdmin:!1}))})):r(e=>({...e,isAuthenticated:!1,user:null,isLoading:!1,isAdmin:!1}))},[]);let t=async(e,t)=>{try{let o=a[e]||e,i=await s.y1.login(o,t);if(i.token&&i.user)return r(r=>({...r,isAuthenticated:!0,user:{id:i.user.id,nome:i.user.nome,email:i.user.email,username:e,role:i.user.role},isLoading:!1,isAdmin:"admin"===i.user.role})),console.log("Login successful, user authenticated:",i.user),!0;return console.log("Login failed - invalid response"),!1}catch(e){return console.error("Erro no login:",e),!1}};return{...e,login:t,logout:()=>{s.y1.logout(),r(e=>({...e,isAuthenticated:!1,user:null,isLoading:!1,isAdmin:!1}))},isAdmin:e.isAdmin}}function n(){let[e,r]=(0,o.useState)([]),[t,a]=(0,o.useState)(!1),i=async()=>{try{a(!0),r([])}catch(e){console.error("Erro ao carregar usu\xe1rios:",e)}finally{a(!1)}};return(0,o.useEffect)(()=>{i()},[]),{users:e,loading:t,addUser:async e=>{try{let r=await s.y1.register(e);return await i(),r.user}catch(e){throw console.error("Erro ao adicionar usu\xe1rio:",e),e}},updateUser:async(e,r)=>{try{await s.y1.updateProfile(r),await i()}catch(e){throw console.error("Erro ao atualizar usu\xe1rio:",e),e}},deleteUser:async e=>{try{await i()}catch(e){throw console.error("Erro ao deletar usu\xe1rio:",e),e}},toggleUserStatus:async e=>{try{await i()}catch(e){throw console.error("Erro ao alterar status do usu\xe1rio:",e),e}},refreshUsers:i}}}},e=>{e.O(0,[4001,1741,4744,2619,8441,1255,7358],()=>e(e.s=2365)),_N_E=e.O()}]);