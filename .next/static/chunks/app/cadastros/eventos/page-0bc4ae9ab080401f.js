(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8064],{63:(e,t,r)=>{"use strict";var a=r(7260);r.o(a,"usePathname")&&r.d(t,{usePathname:function(){return a.usePathname}}),r.o(a,"useRouter")&&r.d(t,{useRouter:function(){return a.useRouter}})},3296:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>c});var a=r(5155),o=r(2115),s=r(4589),n=r(4744);let i={ST:["Pra\xe7a Herois da Forca Expedicionaria Brasileira / Opera\xe7\xe3o Baixas Temperaturas","Pra\xe7a Herois da Forca Expedicionaria Brasileira / Opera\xe7\xe3o Altas Temperaturas"],MG:["Pra\xe7a Novo Mundo / Opera\xe7\xe3o Baixas Temperaturas","Pra\xe7a Novo Mundo / Opera\xe7\xe3o Altas Temperaturas"]};function c(){var e;let[t,r]=(0,o.useState)([]),[c,l]=(0,o.useState)({nome:"",subRegiao:"ST",tipo:"predefinido"}),[d,u]=(0,o.useState)(""),[h,m]=(0,o.useState)(""),x=e=>{l({...c,tipo:e}),"predefinido"===e?l({...c,tipo:e,nome:d}):l({...c,tipo:e,nome:h})};return(0,a.jsx)(s.K,{requiredRole:"admin",children:(0,a.jsx)("div",{className:"min-h-screen bg-zinc-50 dark:bg-zinc-900 py-8",children:(0,a.jsxs)("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8",children:[(0,a.jsxs)("div",{className:"mb-8",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-zinc-900 dark:text-zinc-100",children:"Cadastro de Eventos"}),(0,a.jsx)("p",{className:"mt-2 text-zinc-600 dark:text-zinc-400",children:"Gerencie os eventos dispon\xedveis para relat\xf3rios"})]}),(0,a.jsxs)("div",{className:"bg-white dark:bg-zinc-800 rounded-xl shadow-lg p-6 mb-6",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold text-zinc-900 dark:text-zinc-100 mb-4",children:"Adicionar Novo Evento"}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-zinc-700 dark:text-zinc-300 mb-2",children:"Sub-regi\xe3o"}),(0,a.jsxs)("select",{value:c.subRegiao,onChange:e=>l({...c,subRegiao:e.target.value}),className:"w-full px-3 py-2 border border-zinc-300 dark:border-zinc-600 rounded-lg bg-white dark:bg-zinc-700 text-zinc-900 dark:text-zinc-100 focus:ring-2 focus:ring-green-500 focus:border-transparent",children:[(0,a.jsx)("option",{value:"ST",children:"Santana / Tucuruvi"}),(0,a.jsx)("option",{value:"MG",children:"Vila Maria / Vila Guilherme"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-zinc-700 dark:text-zinc-300 mb-2",children:"Tipo de Evento"}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("label",{className:"flex items-center",children:[(0,a.jsx)("input",{type:"radio",name:"tipo",value:"predefinido",checked:"predefinido"===c.tipo,onChange:()=>x("predefinido"),className:"mr-2"}),(0,a.jsx)("span",{className:"text-zinc-700 dark:text-zinc-300",children:"Evento Predefinido"})]}),(0,a.jsxs)("label",{className:"flex items-center",children:[(0,a.jsx)("input",{type:"radio",name:"tipo",value:"outros",checked:"outros"===c.tipo,onChange:()=>x("outros"),className:"mr-2"}),(0,a.jsx)("span",{className:"text-zinc-700 dark:text-zinc-300",children:"Outros Eventos"})]})]})]}),"predefinido"===c.tipo?(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-zinc-700 dark:text-zinc-300 mb-2",children:"Evento Predefinido"}),(0,a.jsxs)("select",{value:d,onChange:e=>{var t;u(t=e.target.value),l({...c,nome:t})},className:"w-full px-3 py-2 border border-zinc-300 dark:border-zinc-600 rounded-lg bg-white dark:bg-zinc-700 text-zinc-900 dark:text-zinc-100 focus:ring-2 focus:ring-green-500 focus:border-transparent",children:[(0,a.jsx)("option",{value:"",children:"Selecione um evento"}),null==(e=i[c.subRegiao])?void 0:e.map(e=>(0,a.jsx)("option",{value:e,children:e},e))]})]}):(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-zinc-700 dark:text-zinc-300 mb-2",children:"Nome do Evento"}),(0,a.jsx)("input",{type:"text",value:h,onChange:e=>{var t;m(t=e.target.value),l({...c,nome:t})},placeholder:"Digite o nome do evento",className:"w-full px-3 py-2 border border-zinc-300 dark:border-zinc-600 rounded-lg bg-white dark:bg-zinc-700 text-zinc-900 dark:text-zinc-100 focus:ring-2 focus:ring-green-500 focus:border-transparent"})]}),(0,a.jsx)("button",{onClick:()=>{if(!c.nome.trim())return void n.oR.error("Por favor, preencha o nome do evento.");r([...t,{id:Date.now().toString(),nome:c.nome,subRegiao:c.subRegiao,tipo:c.tipo}]),l({nome:"",subRegiao:"ST",tipo:"predefinido"}),u(""),m(""),n.oR.success("Evento adicionado com sucesso!")},className:"w-full bg-green-600 text-white font-bold py-3 px-4 rounded-lg hover:bg-green-700 transition-colors shadow-md",children:"Adicionar Evento"})]})]}),(0,a.jsxs)("div",{className:"bg-white dark:bg-zinc-800 rounded-xl shadow-lg p-6",children:[(0,a.jsxs)("h2",{className:"text-xl font-semibold text-zinc-900 dark:text-zinc-100 mb-4",children:["Eventos Cadastrados (",t.length,")"]}),0===t.length?(0,a.jsx)("div",{className:"text-center py-8 text-zinc-500 dark:text-zinc-400",children:"Nenhum evento cadastrado ainda."}):(0,a.jsx)("div",{className:"space-y-3",children:t.map(e=>(0,a.jsxs)("div",{className:"flex items-center justify-between p-4 bg-zinc-50 dark:bg-zinc-700 rounded-lg",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"font-medium text-zinc-900 dark:text-zinc-100",children:e.nome}),(0,a.jsxs)("div",{className:"text-sm text-zinc-600 dark:text-zinc-400",children:["Sub-regi\xe3o: ",e.subRegiao," | Tipo: ","predefinido"===e.tipo?"Predefinido":"Outros"]})]}),(0,a.jsx)("button",{onClick:()=>{var a;return a=e.id,void(r(t.filter(e=>e.id!==a)),n.oR.success("Evento removido com sucesso!"))},className:"px-3 py-1 bg-red-600 text-white rounded hover:bg-red-700 transition-colors",children:"Remover"})]},e.id))})]})]})})})}},3361:(e,t,r)=>{"use strict";r.d(t,{y1:()=>n,yM:()=>i});let a=r(5704).env.NEXT_PUBLIC_API_URL||"http://localhost:3001/api";class o{setToken(e){this.token=e}clearToken(){this.token=null}async request(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r="".concat(this.baseURL).concat(e),a={headers:{"Content-Type":"application/json",...t.headers},...t};this.token&&(a.headers.Authorization="Bearer ".concat(this.token));try{let e,t=await fetch(r,a),o=t.headers.get("content-type");if(e=o&&o.includes("application/json")?await t.json():await t.blob(),!t.ok)throw Error(e.error||"HTTP ".concat(t.status));return e}catch(e){throw console.error("Erro na requisi\xe7\xe3o:",e),e}}async get(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.request(e,{method:"GET",...t})}async post(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.request(e,{method:"POST",body:JSON.stringify(t),...r})}async put(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.request(e,{method:"PUT",body:JSON.stringify(t),...r})}async delete(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.request(e,{method:"DELETE",...t})}async uploadFile(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=new FormData;a.append("file",t),Object.keys(r).forEach(e=>{a.append(e,r[e])});let o="".concat(this.baseURL).concat(e),s={method:"POST",body:a,headers:{}};this.token&&(s.headers.Authorization="Bearer ".concat(this.token));try{let e=await fetch(o,s),t=await e.json();if(!e.ok)throw Error(t.error||"HTTP ".concat(e.status));return t}catch(e){throw console.error("Erro no upload:",e),e}}async uploadMultipleFiles(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=new FormData;t.forEach(e=>{a.append("files",e)}),Object.keys(r).forEach(e=>{a.append(e,r[e])});let o="".concat(this.baseURL).concat(e),s={method:"POST",body:a,headers:{}};this.token&&(s.headers.Authorization="Bearer ".concat(this.token));try{let e=await fetch(o,s),t=await e.json();if(!e.ok)throw Error(t.error||"HTTP ".concat(e.status));return t}catch(e){throw console.error("Erro no upload m\xfaltiplo:",e),e}}constructor(){this.baseURL=a,this.token=null}}let s=new o,n={async login(e,t){let r=await s.post("/auth/login",{email:e,password:t});return r.token&&(s.setToken(r.token),localStorage.setItem("auth_token",r.token)),r},register:async e=>s.post("/auth/register",e),logout:async()=>(s.clearToken(),localStorage.removeItem("auth_token"),s.post("/auth/logout")),getProfile:async()=>s.get("/auth/profile"),updateProfile:async e=>s.put("/auth/profile",e),changePassword:async e=>s.put("/auth/change-password",e),initToken(){let e=localStorage.getItem("auth_token");e&&s.setToken(e)}},i={async list(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=new URLSearchParams;Object.keys(e).forEach(r=>{void 0!==e[r]&&null!==e[r]&&t.append(r,e[r])});let r=t.toString()?"?".concat(t.toString()):"";return s.get("/relatorios".concat(r))},getById:async e=>s.get("/relatorios/".concat(e)),create:async e=>s.post("/relatorios",e),update:async(e,t)=>s.put("/relatorios/".concat(e),t),delete:async e=>s.delete("/relatorios/".concat(e)),generatePDF:async e=>s.post("/relatorios/".concat(e,"/generate-pdf")),downloadPDF:async(e,t)=>s.get("/relatorios/".concat(e,"/pdf/").concat(t))}},4589:(e,t,r)=>{"use strict";r.d(t,{K:()=>i});var a=r(5155),o=r(8209),s=r(63),n=r(2115);function i(e){let{children:t,requiredRole:r="user",fallbackPath:i="/relatorios"}=e,{isAuthenticated:c,isAdmin:l,isLoading:d}=(0,o.A)(),u=(0,s.useRouter)();if((0,n.useEffect)(()=>{if(!d&&c){let e=!1;switch(r){case"host":case"admin":e=l;break;case"user":e=!0}e||u.push(i)}},[c,l,d,r,i,u]),d)return(0,a.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-blue-50 dark:from-slate-900 dark:to-blue-900 flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),(0,a.jsx)("p",{className:"text-slate-600 dark:text-slate-400",children:"Verificando permiss\xf5es..."})]})});if(!c)return null;let h=!1;switch(r){case"host":case"admin":h=l;break;case"user":h=!0}return h?(0,a.jsx)(a.Fragment,{children:t}):(0,a.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-blue-50 dark:from-slate-900 dark:to-blue-900 flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center bg-white dark:bg-slate-800 p-8 rounded-xl shadow-lg",children:[(0,a.jsx)("div",{className:"text-red-500 text-6xl mb-4",children:"\uD83D\uDEAB"}),(0,a.jsx)("h1",{className:"text-2xl font-bold text-slate-800 dark:text-slate-200 mb-2",children:"Acesso Negado"}),(0,a.jsx)("p",{className:"text-slate-600 dark:text-slate-400 mb-6",children:"Voc\xea n\xe3o tem permiss\xe3o para acessar esta p\xe1gina."}),(0,a.jsx)("button",{onClick:()=>u.push(i),className:"bg-blue-600 hover:bg-blue-700 text-white px-6 py-3 rounded-lg font-semibold transition-colors duration-200",children:"Voltar ao In\xedcio"})]})})}},7009:(e,t,r)=>{Promise.resolve().then(r.bind(r,3296))},8209:(e,t,r)=>{"use strict";r.d(t,{A:()=>n,Y:()=>i});var a=r(2115),o=r(3361);let s={"marcos.silva":"marcos.silva@limpebras.com",admin:"admin@test.com","admin@test.com":"admin@test.com",usuario1:"usuario1@limpebras.com",usuario2:"usuario2@limpebras.com"};function n(){let[e,t]=(0,a.useState)({isAuthenticated:!1,user:null,isLoading:!0,login:async()=>!1,logout:()=>{},isAdmin:!1});(0,a.useEffect)(()=>{localStorage.getItem("auth_token")?(o.y1.initToken(),o.y1.getProfile().then(e=>{t(t=>({...t,isAuthenticated:!0,user:{id:e.id,nome:e.nome,email:e.email,username:e.email.split("@")[0],role:e.role,created_at:e.created_at},isLoading:!1,isAdmin:"admin"===e.role}))}).catch(e=>{console.error("Token inv\xe1lido:",e),localStorage.removeItem("auth_token"),t(e=>({...e,isAuthenticated:!1,user:null,isLoading:!1,isAdmin:!1}))})):t(e=>({...e,isAuthenticated:!1,user:null,isLoading:!1,isAdmin:!1}))},[]);let r=async(e,r)=>{try{let a=s[e]||e,n=await o.y1.login(a,r);if(n.token&&n.user)return t(t=>({...t,isAuthenticated:!0,user:{id:n.user.id,nome:n.user.nome,email:n.user.email,username:e,role:n.user.role},isLoading:!1,isAdmin:"admin"===n.user.role})),console.log("Login successful, user authenticated:",n.user),!0;return console.log("Login failed - invalid response"),!1}catch(e){return console.error("Erro no login:",e),!1}};return{...e,login:r,logout:()=>{o.y1.logout(),t(e=>({...e,isAuthenticated:!1,user:null,isLoading:!1,isAdmin:!1}))},isAdmin:e.isAdmin}}function i(){let[e,t]=(0,a.useState)([]),[r,s]=(0,a.useState)(!1),n=async()=>{try{s(!0),t([])}catch(e){console.error("Erro ao carregar usu\xe1rios:",e)}finally{s(!1)}};return(0,a.useEffect)(()=>{n()},[]),{users:e,loading:r,addUser:async e=>{try{let t=await o.y1.register(e);return await n(),t.user}catch(e){throw console.error("Erro ao adicionar usu\xe1rio:",e),e}},updateUser:async(e,t)=>{try{await o.y1.updateProfile(t),await n()}catch(e){throw console.error("Erro ao atualizar usu\xe1rio:",e),e}},deleteUser:async e=>{try{await n()}catch(e){throw console.error("Erro ao deletar usu\xe1rio:",e),e}},toggleUserStatus:async e=>{try{await n()}catch(e){throw console.error("Erro ao alterar status do usu\xe1rio:",e),e}},refreshUsers:n}}}},e=>{e.O(0,[4744,8441,1255,7358],()=>e(e.s=7009)),_N_E=e.O()}]);